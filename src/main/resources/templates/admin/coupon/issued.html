<!--
    날짜 : 2024/10/30
    이름 : 김소희(최초 작성자)
    내용 : issued 생성

    수정내용
    - 2024/11/01 받은 쿠폰에 대한 화면 출력
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/layout/adminlayout}">

<!-- index.html 고유 CSS 추가 -->
<th:block layout:fragment="css">
  <link rel="stylesheet" th:href="@{/css/admin/coupon/issued.css}" />
</th:block>
<!-- index.html 고유 스크립트 추가 -->
<th:block layout:fragment="script">
</th:block>

<div class="content" layout:fragment="content">
  <div th:replace="~{admin/include/admin_modal :: #couponmodal}"></div>
  <div class="dashboard">
    <div class="content_header">
      <h1>쿠폰발급현황</h1>
      <p>
        HOME > 쿠폰관리 > <strong>쿠폰발급현황</strong>
      </p>
    </div>

    <section class="sectionBox">
      <div>
        <form action="/admin/coupon/list" class="search_bar">
          <select name="type">
            <Option value="couponNo">발급번호</Option>
            <Option value="couponId">쿠폰번호</Option>
            <Option value="couponName">쿠폰명</Option>
          </select>
          <input class="searchInput" type="text" name="keyword">
          <input type="hidden" name="prodSeller" value="ADMIN" readonly>
          <input class="searchBtn" type="submit" value="검색">
        </form>
      </div>
      <table class="admingraph">
        <tr class="admin_title">
          <th>발급번호</th>
          <th>쿠폰번호</th>
          <th>쿠폰종류</th>
          <th>쿠폰명</th>
          <th>사용자</th>
          <th>상태</th>
          <th>사용일</th>
          <th>관리</th>
        </tr>

        <tr th:each="coupon : ${coupontakedtos.dtoList}" class="admin_list">
          <td>
            <a href="#" data-modal="couponmodal" th:attr="data-coupontake-id=${coupon.couponTakenId}" th:text="${coupon.couponTakenId}"></a>
          </td>
          <td>[[${coupon.couponId}]]</td>
          <td>
            <th:block th:switch="${coupon.couponType}">
              <span th:case="single">개별상품 할인</span>
              <span th:case="ordersale">주문상품 할인</span>
              <span th:case="freedelivery">배송비 무료</span>
              <span th:case="*">할인 없음</span> <!-- 기본값 -->
            </th:block>
          </td>
          <td>[[${coupon.couponName}]]</td>
          <td>[[${coupon.username}]]</td>
          <td th:style="'color:' + (${coupon.couponUseCheck == 0} ? 'red' : 'green')">[[${coupon.couponUseCheck == 0 ? '미사용' : '사용'}]]</td>
          <td>[[${coupon.couponUseDateFormatted}]]</td>
          <td>
            <a class="deliveryBtn" th:href="@{'/admin/coupon/cancel/' + ${coupon.couponTakenId}}">중단</a>
          </td>
        </tr>
      </table>

      <div class="pagingBox">
        <div class="pagingList">
          <a th:href="@{/admin/coupon/issued(pg=${coupontakedtos.start - 1}, type=${type}, keyword=${keyword})}"
             th:if="${coupontakedtos.prev}" class="prev">&#60;</a>
          <th:block th:each="num : ${#numbers.sequence(coupontakedtos.start, coupontakedtos.end)}">
            <a th:href="@{/admin/coupon/issued(pg=${num}, type=${type}, keyword=${keyword})}"
               th:classappend="${num == coupontakedtos.pg} ? 'active' : ''">[[${num}]]</a>
          </th:block>
          <a th:href="@{/admin/coupon/issued(pg=${coupontakedtos.end + 1}, type=${type}, keyword=${keyword})}"
             th:if="${coupontakedtos.next}" class="next">&#62;</a>
        </div>
      </div>

    </section>
  </div>
</div>
</html>