<!--
    날짜 : 2024/10/25
    이름 : 김소희
    내용 : 나의정보 홈 화면

    수정이력
   - 2024/11/06 이도영 - 구매내용 출력, 나의정보 출력
   - 2024/11/07 박서홍 - 포인트적립 출력, 일자별 검색 기능, 전체주문 페이징처리

-->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>롯데ON::대한민국 1등 온라인 쇼핑몰</title>
    <link rel="stylesheet" th:href="@{/css/my/home.css}"/>
    <link rel="stylesheet" th:href="@{/css/reset.css}" />
    <link rel="stylesheet" th:href="@{/css/my/modal.css}">
    <script type="text/javascript" th:src="@{/js/modal/modal.js}"></script>
    <script type="text/javascript" th:src="@{/js/my/searchPeriod.js}"></script>
    <div th:replace="layout/modal :: #orderDetailModal"></div>
    <div th:replace="layout/modal :: #sellerInfoModal"></div>
    <div th:replace="layout/modal :: #inquiryModal"></div>
    <div th:replace="layout/modal :: #receiptConfirmModal"></div>
    <div th:replace="layout/modal :: #reviewModal"></div>
    <div th:replace="layout/modal :: #refundModal"></div>
    <div th:replace="layout/modal :: #returnModal"></div>
</head>

<body>
<header th:replace="~{layout/header::header}"></header>
    <div id="wrapper">
        <div>
            <th:replace th:replace="~{myPage/include/mypagenav::nav}"></th:replace>
            <!-- only for info header -->
            <div class="info">
                <div th:replace="~{myPage/include/mypagesidebar::sidebar}"></div>

                <section>
                    <a href="#"><img src="/images/my/my_banner_sample.png" alt="롯데ON에서 드리는 다양한 결제혜택" class="banner"></a>

                    <!-- 사이드 영역 -->
                    <article class="latest">
                        <h3>최근주문내역</h3>
                        <a th:href="@{/myPage/ordered}" class="more">더보기 &gt;</a>
                        <table border="0" class="widthtable">
                            <tr>
                                <th>날짜</th>
                                <th></th>
                                <th>상품정보</th>
                                <th>상태</th>
                                <th>확인/신청</th>
                            </tr>
                            <block>
                                <!-- myorder 리스트가 비어있을 경우 -->
                                <tr th:if="${myOrderItems == null or myOrderItems.size() == 0}">
                                    <td colspan="5" class="td_first" style="width: 100%">최근 주문 내역이 없습니다.</td>
                                </tr>
                                <tr th:each="myOrderItem : ${myOrderItems}" th:data-product-id="${myOrderItem.product.id}" th:data-product-name="${myOrderItem.product.productName}" >
                                    <td class="date">2022-12-13</td>
                                    <td><a href="#" class="recentproductorderimg"><img  th:src="'/'+${appInfo.uploadDir}+'product/'+${myOrderItem.getProduct().getProductImg1()}" alt="상품이미지"></a></td>
                                    <td class="order-info">
                                        <div class="order-number">
                                            주문번호: <a href="#" th:text="${myOrderItem.getOrder().getId()}" data-modal="orderDetailModal"></a>
                                        </div>
                                        <div class="company-name" th:text="${myOrderItem.getProduct().getShop().getShopName()}" data-modal="sellerInfoModal">실바니안패밀리</div>
                                        <div class="product-name" th:text="${myOrderItem.getProductName()}">플로라 토끼 남매의 꽃 가꾸기</div>
                                        <div>수량 : <span th:text="${myOrderItem.getQuantity()}"></span>1 개</div>
                                        <div class="product-price" style="font-size: 18px; font-weight: bold;" th:text="${myOrderItem.getOrder().getTotalPrice()}">25,900원</div>
                                    </td>

                                    <td class="status">[[${myOrderItem.deliveryStatus}]]</td>
                                    <td >
                                        <!-- 수취확인 -->
                                        <button class="receivebutton" data-modal="receiptConfirmModal">수취확인</button><br>
                                        <button class="receivebutton" data-modal="reviewModal">상품평쓰기</button><br>
                                        <button class="reviewbutton" data-modal="refundModal">반품신청</button><br>
                                        <button class="reviewbutton" data-modal="returnModal">교환신청</button>
                                    </td>
                                </tr>
                            </block>
                        </table>
                    </article>

                    <article class="point">
                        <h3>포인트적립내역</h3>

                        <a th:href="@{/myPage/point}" class="more">더보기 &gt;</a>
                        <table border="0" class="widthtable">
                            <tr>
                                <th><input type="checkbox" name="all" onchange="toggleAllChecks(this)" /></th>
                                <th>날짜</th>
                                <th>구분</th>
                                <th>주문번호</th>
                                <th>적립금액</th>
                                <th>비고</th>
                                <th>유효기간</th>
                            </tr>
                            <tr th:each="point : ${points}" class="admin_list">
                                    <td><input type="checkbox" name="RowCheck" th:value="${point.id}" /></td>
                                    <td th:text="${point.formattedCreatedAt}"></td> <!-- 날짜 포맷 -->
                                    <td th:text="${point.transactionType.toString()}"></td>
                                    <td th:text="${point.order_id != null ? point.order_id : point.type}">2022121001</td>
                                    <td th:text="${point.acPoints}"></td>
                                    <td th:text="${point.type}"></td>
                                    <td th:text="${point.formattedExpirationDate}">2025-10-24</td>
                                </tr>
                        </table>
                    </article>
                    <article class="review">
                        <div>
                        <h3>상품평</h3>
                        <a th:href="@{/myPage/review}" class="more">더보기 &gt;</a>
                        </div>
                        <table border="0" class="widthtable">
                            <tr>
                                <th>번호</th>
                                <th>상품명</th>
                                <th>내용</th>
                                <th>평점</th>
                                <th>작성일</th>
                            </tr>
                            <block each="review , loop:${reviewLimit5}">
                                <tr>
                                    <td text="${loop.index+1}">1</td>
                                    <td text="${review.prodName}">상품명</td>
                                    <td text="${review.content}">배송이 빠릅니다. 잘 사용하겠습니다.</td>
                                    <td class="score">
                                        <span class="rating" if="${review.rating == 1}" classappend="star1">평점</span>
                                        <!-- <span class="rating" if="${review.rating == 2}" classappend="star2">평점</span>
                                    <span class="rating" if="${review.rating == 3}" classappend="star3">평점</span>
                                    <span class="rating" if="${review.rating == 4}" classappend="star4">평점</span>
                                    <span class="rating" if="${review.rating == 5}" classappend="star5">평점</span> -->
                                    </td>
                                    <td text="${review.rdate.toLocalDate()}">2022-12-10</td>
                                </tr>
                                <tr>
                                    <td text="${loop.index+1}">2</td>
                                    <td text="${review.prodName}">상품명</td>
                                    <td text="${review.content}">배송이 빠릅니다. 잘 사용하겠습니다.</td>
                                    <td class="score">
                                        <span class="rating" if="${review.rating == 1}" classappend="star1">평점</span>
                                    </td>
                                    <td text="${review.rdate.toLocalDate()}">2022-12-10</td>
                                </tr>
                                <tr>
                                    <td text="${loop.index+1}">3</td>
                                    <td text="${review.prodName}">상품명</td>
                                    <td text="${review.content}">배송이 빠릅니다. 잘 사용하겠습니다.</td>
                                    <td class="score">
                                        <span class="rating" if="${review.rating == 1}" classappend="star1">평점</span>
                                    </td>
                                    <td text="${review.rdate.toLocalDate()}">2022-12-10</td>
                                </tr>
                            </block>
                        </table>
                    </article>
                    <article class="qna">
                        <h3>문의내역</h3>
                        <a th:href="@{/myPage/qna}" class="more">더보기 &gt;</a>
                        <table border="0" class="widthtable">
                            <tr>
                                <th>번호</th>
                                <th>문의채널</th>
                                <th>문의유형</th>
                                <th>제목</th>
                                <th>작성일</th>
                                <th>상태</th>
                            </tr>
                            <block each="qna,loop:${qnaLimit5}">
                                <tr>
                                    <td text="${loop.index+1}">5</td>
                                    <block if="${qna.cate1 == qna}">
                                        <td class="channel">고객센터</td>
                                    </block>
                                    <block if="${qna.cate1 != qna}">
                                        <td class="channel">판매자게시판</td>
                                    </block>
                                    <!-- <td text="${qna.detail}">주문/결제</td> -->
                                    <td text="${qna.title}">신용카드 결제 중 오류가 난 경우 어떻게 하나요?</td>
                                    <td text="${qna.rdate.toLocalDate()}">2024-12-12</td>
                                    <td class="status">
                                        <block if="${qna.comment ==1}">
                                            <span class="answered">답변완료</span>
                                        </block>
                                        <block if="${qna.comment ==0}">
                                            <span class="answered">검토중</span>
                                        </block>
                                    </td>
                                </tr>
                            </block>
                        </table>
                    </article>
                    <h3>나의설정</h3>
                    <article class="myinfo">
                        <div class="myinfosetting">
                            <div class="address">
                                <span>기본 배송지</span>
                                <a th:href="@{/myPage/info}" class="setting">&nbsp;&nbsp;변경</a>
                                <p>
                                    <span th:text="${'우편번호 : '+address.zip}">부산광역시</span><br />
                                    <span th:text="${'상세주소 :'+address.addr1 +' '+address.addr2}">서면</span><br />
                                </p>
                            </div>
                            <div class="email">
                                <span>Email</span>
                                <a th:href="@{/myPage/info}" class="setting">&nbsp;&nbsp;변경</a>
                                <p>
                                    <span th:text="${member.email}">abc123@gmail.com</span><br />
                                </p>
                            </div>
                            <div class="hp">
                                <span>휴대폰</span>
                                <a th:href="@{/myPage/info}" class="setting">&nbsp;&nbsp;변경</a>
                                <p>
                                    <span th:text="${member.ph}">abc123@gmail.com</span><br />
                                </p>
                            </div>
                        </div>
                    </article>
                </section>
            </div>
        </div>
    </div>
    <footer th:replace="~{layout/footer::footer}"></footer>
    <script>

    </script>
</body>

</html>